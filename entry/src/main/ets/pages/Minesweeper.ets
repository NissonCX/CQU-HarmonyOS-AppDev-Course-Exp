// Minesweeper.ets
import { promptAction } from '@kit.ArkUI'; // å¯¼å…¥ç”¨äºæ˜¾ç¤ºå¯¹è¯æ¡†çš„å·¥å…·
import router from '@ohos.router';
import { Cell } from '../model/Cell'
import { ThemeManager } from '../model/ThemeManager';
import { ThemeType, ThemeColors } from '../model/Theme';

// å®šä¹‰æ‰«é›·æ¸¸æˆç»„ä»¶
@Entry
  // ä½¿ç”¨@Entryè£…é¥°å™¨å£°æ˜è¿™æ˜¯ä¸€ä¸ªå…¥å£ç»„ä»¶
@Component
  // ä½¿ç”¨@Componentè£…é¥°å™¨å£°æ˜è¿™æ˜¯ä¸€ä¸ªç»„ä»¶
struct MineSweeper {
  @State private gameBoard: Cell[][] = []; // æ¸¸æˆé¢æ¿æ•°æ®
  @State private mineCount: number = 10; // åœ°é›·æ€»æ•°
  @State private revealedCells: Set<string> = new Set(); // å·²ç»æ­ç¤ºçš„æ–¹å—é›†åˆ
  @State private flaggedCells: Set<string> = new Set(); // æ ‡è®°ä¸ºåœ°é›·çš„æ–¹å—é›†åˆ
  @State private cellSize: number = 60; // ç¼©å°æ–¹å—å¤§å°
  @State private cellMargin: number = 1; // ç¼©å°æ–¹å—è¾¹è·
  @State private currentTime: number = 0; // å½“å‰æ¸¸æˆæ—¶é—´ï¼ˆç§’ï¼‰
  @State private isFlagMode: boolean = false; // æ˜¯å¦ä¸ºæ ‡è®°æ¨¡å¼
  private startTime: number = Date.now(); // æ¸¸æˆå¼€å§‹æ—¶é—´
  @State private isGameOver: boolean = false; // æ¸¸æˆç»“æŸæ ‡å¿—
  private timerId: number = -1; // å®šæ—¶å™¨ID
  
  // ä¸»é¢˜ç›¸å…³çŠ¶æ€
  @State private currentTheme: ThemeType = ThemeManager.getInstance().getCurrentTheme();
  @State private themeColors: ThemeColors = ThemeManager.getInstance().getCurrentColors();
  
  // ç»„ä»¶åŠ è½½æ—¶åˆå§‹åŒ–æ¸¸æˆå’Œæ·»åŠ ä¸»é¢˜ç›‘å¬å™¨
  aboutToAppear(): void {
    this.initializeGame();
    
    // æ·»åŠ ä¸»é¢˜ç›‘å¬å™¨
    ThemeManager.getInstance().addThemeChangeListener((theme: ThemeType, colors: ThemeColors) => {
      this.currentTheme = theme;
      this.themeColors = colors;
    });
  }
  
  // ç»„ä»¶é”€æ¯æ—¶æ¸…é™¤å®šæ—¶å™¨å’Œç§»é™¤ä¸»é¢˜ç›‘å¬å™¨
  aboutToDisappear(): void {
    // æ¸…é™¤å®šæ—¶å™¨
    if (this.timerId !== -1) {
      clearInterval(this.timerId);
      this.timerId = -1;
    }
    
    // æ³¨æ„ï¼šåœ¨å®é™…åº”ç”¨ä¸­ï¼Œåº”è¯¥ä¿å­˜ç›‘å¬å™¨çš„å¼•ç”¨ä»¥ä¾¿ç§»é™¤
    // è¿™é‡Œä¸ºäº†ç®€åŒ–ï¼Œæš‚æ—¶ä¸å®ç°ç§»é™¤é€»è¾‘
  }
  
  // åˆå§‹åŒ–æ¸¸æˆ
  private initializeGame() {
    // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
    if (this.timerId !== -1) {
      clearInterval(this.timerId);
      this.timerId = -1;
    }
    
    // é‡ç½®æ¸¸æˆæ—¶é—´
    this.startTime = Date.now();
    this.currentTime = 0;
    
    // é‡ç½®æ¸¸æˆçŠ¶æ€
    this.revealedCells = new Set();
    this.flaggedCells = new Set();
    this.isFlagMode = false;
    this.isGameOver = false;
    
    // å¯åŠ¨è®¡æ—¶å™¨
    this.timerId = setInterval(() => {
      if (!this.isGameOver) {
        this.currentTime = Math.floor((Date.now() - this.startTime) / 1000);
      }
    }, 1000);

    this.generateBoard(); // ç”Ÿæˆæ–°çš„æ¸¸æˆé¢æ¿
  }

  // åˆ‡æ¢æ“ä½œæ¨¡å¼
  private toggleMode() {
    if (this.isGameOver) return;
    this.isFlagMode = !this.isFlagMode;
  }

  // ç”Ÿæˆæ¸¸æˆé¢æ¿
  private generateBoard() {
    this.gameBoard = []; // æ¸…ç©ºæ¸¸æˆé¢æ¿
    for (let i = 0; i < 10; i++) { // å¾ªç¯åˆ›å»º10è¡Œ
      this.gameBoard.push([]); // æ¯è¡Œåˆå§‹åŒ–ä¸ºç©ºæ•°ç»„
      for (let j = 0; j < 10; j++) { // å¾ªç¯åˆ›å»º10åˆ—
        this.gameBoard[i].push(new Cell(i, j)); // ä¸ºæ¯ä¸ªä½ç½®åˆ›å»ºä¸€ä¸ªæ–°æ–¹å—
      }
    }
    this.placeMines(); // éšæœºæ”¾ç½®åœ°é›·
    this.calculateNumbers(); // è®¡ç®—æ¯ä¸ªæ–¹å—å‘¨å›´çš„åœ°é›·æ•°é‡
  }

  // éšæœºæ”¾ç½®åœ°é›·
  private placeMines() {
    let placed = 0; // å·²æ”¾ç½®çš„åœ°é›·æ•°é‡
    while (placed < this.mineCount) { // å½“å·²æ”¾ç½®çš„åœ°é›·å°‘äºè®¾å®šæ•°é‡æ—¶ç»§ç»­æ”¾ç½®
      let x = Math.floor(Math.random() * 10); // éšæœºé€‰æ‹©ä¸€è¡Œ
      let y = Math.floor(Math.random() * 10); // éšæœºé€‰æ‹©ä¸€åˆ—
      if (!this.gameBoard[x][y].hasMine) { // å¦‚æœè¯¥ä½ç½®è¿˜æ²¡æœ‰åœ°é›·
        this.gameBoard[x][y].hasMine = true; // åœ¨è¯¥ä½ç½®æ”¾ç½®åœ°é›·
        placed++; // åœ°é›·è®¡æ•°åŠ 1
      }
    }
  }

  // è®¡ç®—æ¯ä¸ªæ–¹å—å‘¨å›´çš„åœ°é›·æ•°é‡
  private calculateNumbers() {
    for (let i = 0; i < 10; i++) { // éå†æ¯ä¸€è¡Œ
      for (let j = 0; j < 10; j++) { // éå†æ¯ä¸€åˆ—
        if (!this.gameBoard[i][j].hasMine) { // å¦‚æœå½“å‰æ–¹å—ä¸æ˜¯åœ°é›·
          this.gameBoard[i][j].neighborMines = this.countNeighborMines(i, j); // è®¡ç®—å¹¶è®¾ç½®å‘¨å›´åœ°é›·æ•°é‡
          this.gameBoard[i][j].value = this.gameBoard[i][j].neighborMines.toString(); // å°†æ•°é‡è½¬æ¢ä¸ºå­—ç¬¦ä¸²
        } else {
          this.gameBoard[i][j].value = 'ğŸ’£'; // å¦‚æœæ˜¯åœ°é›·ï¼Œåˆ™è®¾ç½®å€¼ä¸ºç‚¸å¼¹emoji
        }
      }
    }
  }

  // è®¡ç®—ç»™å®šåæ ‡å‘¨å›´åœ°é›·çš„æ•°é‡
  private countNeighborMines(row: number, col: number): number {
    let count = 0; // å‘¨å›´åœ°é›·è®¡æ•°
    for (let dx = -1; dx <= 1; dx++) { // éå†ä¸Šä¸‹å·¦å³åŠå¯¹è§’çº¿æ–¹å‘
      for (let dy = -1; dy <= 1; dy++) {
        if (dx === 0 && dy === 0) { // è·³è¿‡å½“å‰ä½ç½®
          continue;
        }
        let newRow = row + dx, newCol = col + dy; // æ–°çš„è¡Œåˆ—åæ ‡
        if (newRow >= 0 && newRow < 10 && newCol >= 0 && newCol < 10 &&
        this.gameBoard[newRow][newCol].hasMine) { // å¦‚æœæ–°ä½ç½®æœ‰æ•ˆä¸”æ˜¯åœ°é›·
          count++; // åœ°é›·è®¡æ•°åŠ 1
        }
      }
    }
    return count; // è¿”å›åœ°é›·è®¡æ•°
  }

  // æ­ç¤ºæ–¹å—
  private revealCell(row: number, col: number) {
    // å¦‚æœæ¸¸æˆç»“æŸã€è¯¥æ–¹å—å·²ç»è¢«æ­ç¤ºã€æˆ–è€…è¯¥æ–¹å—å·²è¢«æ ‡è®°ä¸ºæ——å¸œï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œ
    if (this.isGameOver || this.revealedCells.has(`${row},${col}`) || this.gameBoard[row][col].isFlag) {
      return;
    }
    
    const key = `${row},${col}`; // åˆ›å»ºæ–¹å—å”¯ä¸€æ ‡è¯†
    this.revealedCells.add(key); // æ·»åŠ åˆ°å·²æ­ç¤ºçš„æ–¹å—é›†åˆ
    
    if (this.gameBoard[row][col].hasMine) { // å¦‚æœæ­ç¤ºçš„æ–¹å—æ˜¯åœ°é›·
      this.showGameOverDialog(); // æ˜¾ç¤ºæ¸¸æˆç»“æŸå¯¹è¯æ¡†
    } else {
      if (this.gameBoard[row][col].neighborMines === 0) { // å¦‚æœæ­ç¤ºçš„æ–¹å—å‘¨å›´æ²¡æœ‰åœ°é›·
        for (let dx = -1; dx <= 1; dx++) { // è‡ªåŠ¨æ­ç¤ºå‘¨å›´æ‰€æœ‰æ–¹å—
          for (let dy = -1; dy <= 1; dy++) {
            if (dx === 0 && dy === 0) { // è·³è¿‡å½“å‰ä½ç½®
              continue;
            }
            let newRow = row + dx, newCol = col + dy;
            if (newRow >= 0 && newRow < 10 && newCol >= 0 && newCol < 10) { // å¦‚æœæ–°ä½ç½®æœ‰æ•ˆ
              this.revealCell(newRow, newCol); // é€’å½’æ­ç¤ºç›¸é‚»æ–¹å—
            }
          }
        }
      }
    }
    
    if (this.isVictory()) { // å¦‚æœæ¸¸æˆèƒœåˆ©
      this.showVictoryDialog(); // æ˜¾ç¤ºèƒœåˆ©å¯¹è¯æ¡†
    }
  }

  // æ ‡è®°æ–¹å—
  private flagCell(row: number, col: number) {
    if (this.isGameOver || this.revealedCells.has(`${row},${col}`)) {
      return;
    }

    const cell = this.gameBoard[row][col];
    cell.isFlag = !cell.isFlag;
  }

  // å¤„ç†æ–¹å—ç‚¹å‡»äº‹ä»¶
  private handleCellClick(row: number, col: number) {
    if (this.isFlagMode) {
      this.flagCell(row, col);
    } else {
      this.revealCell(row, col);
    }
  }

  // æ˜¾ç¤ºæ¸¸æˆç»“æŸå¯¹è¯æ¡†
  private showGameOverDialog() {
    this.isGameOver = true; // è®¾ç½®æ¸¸æˆç»“æŸ
    // æ¸…é™¤å®šæ—¶å™¨
    if (this.timerId !== -1) {
      clearInterval(this.timerId);
      this.timerId = -1;
    }

    promptAction.showDialog({
      // æ˜¾ç¤ºå¯¹è¯æ¡†
      title: 'ğŸ’€ æ¸¸æˆç»“æŸ: æ¸¸æˆå¤±è´¥ï¼',
      message: `ç”¨æ—¶ï¼š${this.currentTime}ç§’`,
      buttons: [{ text: 'ğŸ”„ é‡æ–°å¼€å§‹', color: '#007DFF' }]
    }).then(() => { // ç‚¹å‡»æŒ‰é’®åæ‰§è¡Œ
      this.initializeGame(); // é‡æ–°å¼€å§‹æ¸¸æˆ
    });
  }

  // æ˜¾ç¤ºèƒœåˆ©å¯¹è¯æ¡†
  private showVictoryDialog() {
    this.isGameOver = true; // è®¾ç½®æ¸¸æˆç»“æŸ
    // æ¸…é™¤å®šæ—¶å™¨
    if (this.timerId !== -1) {
      clearInterval(this.timerId);
      this.timerId = -1;
    }

    promptAction.showDialog({
      // æ˜¾ç¤ºå¯¹è¯æ¡†
      title: 'ğŸ‰ æ­å–œä½ ï¼Œæ¸¸æˆèƒœåˆ©ï¼',
      message: `ç”¨æ—¶ï¼š${this.currentTime}ç§’`,
      buttons: [{ text: 'ğŸ”„ é‡æ–°å¼€å§‹', color: '#007DFF' }]
    }).then(() => { // ç‚¹å‡»æŒ‰é’®åæ‰§è¡Œ
      this.initializeGame(); // é‡æ–°å¼€å§‹æ¸¸æˆ
    });
  }

  // åˆ¤æ–­æ¸¸æˆæ˜¯å¦èƒœåˆ©
  private isVictory(): boolean {
    let revealedNonMineCount = 0; // éåœ°é›·æ–¹å—çš„æ­ç¤ºæ•°é‡
    for (let i = 0; i < this.gameBoard.length; i++) { // éå†æ¯ä¸€è¡Œ
      for (let j = 0; j < this.gameBoard[i].length; j++) { // éå†æ¯ä¸€åˆ—
        if (this.revealedCells.has(`${i},${j}`)) { // å¦‚æœæ–¹å—å·²è¢«æ­ç¤º
          revealedNonMineCount++; // éåœ°é›·æ–¹å—çš„æ­ç¤ºæ•°é‡åŠ 1
        }
      }
    }
    return revealedNonMineCount == 90; // å¦‚æœéåœ°é›·æ–¹å—å…¨éƒ¨æ­ç¤ºï¼Œåˆ™æ¸¸æˆèƒœåˆ©
  }

  // å†³å®šæ˜¯å¦æ˜¾ç¤ºæ–¹å—å€¼
  private isShowValue(cell: Cell): string {
    if (this.isGameOver) { // å¦‚æœæ¸¸æˆç»“æŸ
      return cell.value === '0' ? '' : cell.value; // æ˜¾ç¤ºæ–¹å—å€¼ï¼Œé™¤éæ˜¯0
    } else {
      if (this.revealedCells.has(`${cell.row},${cell.column}`)) { // å¦‚æœæ–¹å—å·²è¢«æ­ç¤º
        return cell.value === '0' ? '' : cell.value; // æ˜¾ç¤ºæ–¹å—å€¼ï¼Œé™¤éæ˜¯0
      } else {
        return ''; // å¦åˆ™ä¸æ˜¾ç¤ºå€¼
      }
    }
  }

  // æ„å»ºç”¨æˆ·ç•Œé¢
  build() {
    Column() {
      // æ ‡é¢˜åŒºåŸŸ - å±…ä¸­å¯¹ç§°å¸ƒå±€
      Column() {
        Row() {
          // è¿”å›æŒ‰é’®
          Button('â†')
            .width(40)
            .height(40)
            .backgroundColor(this.themeColors.buttonBackground)
            .fontColor(this.themeColors.buttonText)
            .borderRadius(20)
            .border({ width: 1, color: this.themeColors.buttonBorder })
            .shadow({
              radius: 4,
              color: this.themeColors.cardShadow,
              offsetX: 1,
              offsetY: 1
            })
            .onClick(() => {
              router.back();
            })
          
          // æ ‡é¢˜åŒºåŸŸ
          Column() {
            Text('ğŸš© æ‰«é›·æ¸¸æˆ ğŸ’¥')
              .fontSize(28)
              .fontWeight(FontWeight.Bold)
              .textAlign(TextAlign.Center)
              .fontColor(this.themeColors.primaryText)

            Text('ç‚¹å‡»æ­å¼€æ¨¡å¼åˆ‡æ¢ä¸ºæ ‡è®°æ¨¡å¼')
              .fontSize(14)
              .fontColor(this.themeColors.secondaryText)
              .margin({ top: 6 })
          }
          .layoutWeight(1)
          .alignItems(HorizontalAlign.Center)
          
          // å ä½ç¬¦ä¿æŒå¯¹ç§°
          Column()
            .width(40)
            .height(40)
        }
        .width('100%')
        .padding({ left: 20, right: 20 })
        .margin({ top: 20, bottom: 20 })

        // æ—¶é—´æ˜¾ç¤º - å±…ä¸­
        Row() {
          Text('â±')
            .fontSize(14)
            .fontColor(this.themeColors.secondaryText)
            .margin({ right: 8 })
          
          Text(`${this.currentTime.toString().padStart(3, '0')}s`)
            .fontSize(18)
            .fontWeight(FontWeight.Medium)
            .fontColor(this.themeColors.buttonText)
        }
        .padding({ left: 20, right: 20, top: 12, bottom: 12 })
        .backgroundColor(this.themeColors.cardBackground)
        .borderRadius(20)
        .border({ width: 1, color: this.themeColors.cardBorder })
        .shadow({
          radius: 6,
          color: this.themeColors.cardShadow,
          offsetX: 2,
          offsetY: 2
        })
        .alignSelf(ItemAlign.Center)
        .margin({ bottom: 20 })
      }
      .width('100%')
      .alignItems(HorizontalAlign.Center)
      .margin({ bottom: 10 })

      // æ¸¸æˆä¸»åŒºåŸŸ
      Column() {
        // æ¸¸æˆé¢æ¿
        Flex({ wrap: FlexWrap.Wrap }) {
          ForEach(this.gameBoard, (row: Cell[], rowIndex: number) => {
            ForEach(row, (cell: Cell, colIndex: number) => {
              Stack() {
                // æ ¼å­èƒŒæ™¯
                Rect()
                  .width(`${this.cellSize}lpx`)
                  .height(`${this.cellSize}lpx`)
                  .margin(`${this.cellMargin}lpx`)
                  .fill(this.revealedCells.has(`${rowIndex},${colIndex}`) ?
                    (this.isShowValue(cell) === 'ğŸ’£' ? this.themeColors.gameCellMine : this.themeColors.gameCellRevealed) : 
                    this.themeColors.gameCellBackground)
                  .strokeWidth(1)
                  .stroke(this.themeColors.gameCellBorder)
                  .radius(8)
                  .shadow({
                    radius: 4,
                    color: this.themeColors.cardShadow,
                    offsetX: 2,
                    offsetY: 2
                  })

                // æ ¼å­å†…å®¹
                Text(this.isShowValue(cell))
                  .width(`${this.cellSize}lpx`)
                  .height(`${this.cellSize}lpx`)
                  .margin(`${this.cellMargin}lpx`)
                  .fontSize(`${this.cellSize / 2 + 2}lpx`)
                  .textAlign(TextAlign.Center)
                  .fontColor(this.revealedCells.has(`${rowIndex},${colIndex}`) ?
                    (this.isShowValue(cell) === 'ğŸ’£' ? '#FFFFFF' : this.themeColors.primaryText) :
                    '#FFFFFF')
                  .fontWeight(FontWeight.Bold)

                // æ ‡è®°æ——å¸œ
                Text(`${cell.isFlag && !this.revealedCells.has(`${rowIndex},${colIndex}`) ? 'ğŸš©' : ''}`)
                  .width(`${this.cellSize}lpx`)
                  .height(`${this.cellSize}lpx`)
                  .margin(`${this.cellMargin}lpx`)
                  .fontSize(`${this.cellSize / 2 + 2}lpx`)
                  .textAlign(TextAlign.Center)
                  .fontColor('#E53935')
                  .visibility(cell.isFlag && !this.revealedCells.has(`${rowIndex},${colIndex}`) && !this.isGameOver ?
                  Visibility.Visible : Visibility.None)
              }
              .onClick(() => this.handleCellClick(rowIndex, colIndex))
            });
          });
        }
        .width(`${(this.cellSize + this.cellMargin * 2) * 10}lpx`)
        .margin({ top: 10, bottom: 10 })
      }
      .width('100%')
      .alignItems(HorizontalAlign.Center)
      .justifyContent(FlexAlign.Center)
      .layoutWeight(1)

      // æ§åˆ¶æŒ‰é’®åŒºåŸŸ - å±…ä¸­å¯¹ç§°å¸ƒå±€
      Column({ space: 16 }) {
        // æ¨¡å¼åˆ‡æ¢æŒ‰é’®
        Button(`${this.isFlagMode ? 'ğŸš© æ ‡è®°æ¨¡å¼' : 'ğŸ‘† æ­å¼€æ¨¡å¼'}`)
          .fontColor(this.themeColors.buttonText)
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .width(200)
          .height(50)
          .backgroundColor(this.themeColors.buttonBackground)
          .borderRadius(14)
          .border({ width: 1, color: this.themeColors.buttonBorder })
          .shadow({
            radius: 8,
            color: this.themeColors.cardShadow,
            offsetX: 2,
            offsetY: 2
          })
          .onClick(() => this.toggleMode())

        // é‡æ–°å¼€å§‹æŒ‰é’®
        Button('ğŸ”„ é‡æ–°å¼€å§‹')
          .fontColor(this.themeColors.buttonText)
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .width(200)
          .height(50)
          .backgroundColor(this.themeColors.buttonBackground)
          .borderRadius(14)
          .border({ width: 1, color: this.themeColors.buttonBorder })
          .shadow({
            radius: 8,
            color: this.themeColors.cardShadow,
            offsetX: 2,
            offsetY: 2
          })
          .onClick(() => {
            promptAction.showDialog({
              title: 'ğŸ¤” ç¡®è®¤é‡æ–°å¼€å§‹',
              message: 'ç¡®å®šè¦é‡æ–°å¼€å§‹æ¸¸æˆå—ï¼Ÿå½“å‰æ¸¸æˆè¿›åº¦å°†ä¼šä¸¢å¤±ã€‚',
              buttons: [
                {
                  text: 'âœ… ç¡®å®š',
                  color: '#007DFF'
                },
                {
                  text: 'âŒ å–æ¶ˆ',
                  color: '#999999'
                }
              ]
            }).then((result) => {
              if (result.index == 0) {
                // ç”¨æˆ·ç‚¹å‡»"ç¡®å®š"
                this.initializeGame();
              }
              // ç”¨æˆ·ç‚¹å‡»"å–æ¶ˆ"æˆ–å…¶ä»–æƒ…å†µï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œ
            });
          })
      }
      .width('100%')
      .alignItems(HorizontalAlign.Center)
      .margin({ top: 10, bottom: 10 })

      // åº•éƒ¨ä¿¡æ¯åŒºåŸŸ - å±…ä¸­å¸ƒå±€
      Column() {
        Text('ğŸ¯ æ‰«é›·æ˜¯ä¸€ä¸ªç»å…¸çš„æ¸¸æˆï¼Œè€ƒéªŒä½ çš„é€»è¾‘æ¨ç†èƒ½åŠ›')
          .fontSize(12)
          .fontColor(this.themeColors.tertiaryText)
          .margin({ bottom: 6 })

        Text('ğŸ§  é€»è¾‘æ¨ç† Â· â±ï¸ æŒ‘æˆ˜é€Ÿåº¦')
          .fontSize(11)
          .fontColor(this.themeColors.tertiaryText)
          .margin({ bottom: 6 })

        Text('ğŸ‘¨â€ğŸ’» åˆ¶ä½œäººï¼šNisson_CX')
          .fontSize(11)
          .fontColor(this.themeColors.tertiaryText)
          .margin({ bottom: 20 })
      }
      .width('100%')
      .alignItems(HorizontalAlign.Center)
    }
    .width('100%')
    .height('100%')
    .backgroundColor(this.themeColors.background)
    .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])
  }
}